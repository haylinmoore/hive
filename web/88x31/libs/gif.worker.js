(function(b){function a(b,d){if({}.hasOwnProperty.call(a.cache,b))return a.cache[b];var e=a.resolve(b);if(!e)throw new Error('Failed to resolve module '+b);var c={id:b,require:a,filename:b,exports:{},loaded:!1,parent:d,children:[]};d&&d.children.push(c);var f=b.slice(0,b.lastIndexOf('/')+1);return a.cache[b]=c.exports,e.call(c.exports,c,c.exports,f,b),c.loaded=!0,a.cache[b]=c.exports}a.modules={},a.cache={},a.resolve=function(b){return{}.hasOwnProperty.call(a.modules,b)?a.modules[b]:void 0},a.define=function(b,c){a.modules[b]=c},a.define('/gif.worker.coffee',function(d,e,f,g){var b,c;b=a('/GIFEncoder.js',d),c=function(a){var c,e,d,f;return c=new b(a.width,a.height),a.index===0?c.writeHeader():c.firstFrame=!1,c.setTransparent(a.transparent),c.setRepeat(a.repeat),c.setDelay(a.delay),c.setQuality(a.quality),c.setPreserveColors(a.preserveColors),c.addFrame(a.data),a.last&&c.finish(),d=c.stream(),a.data=d.pages,a.cursor=d.cursor,a.pageSize=d.constructor.pageSize,a.canTransfer?(f=function(c){for(var b=0,d=a.data.length;b<d;++b)e=a.data[b],c.push(e.buffer);return c}.call(this,[]),self.postMessage(a,f)):self.postMessage(a)},self.onmessage=function(a){return c(a.data)}}),a.define('/GIFEncoder.js',function(e,i,j,k){function c(){this.page=-1,this.pages=[],this.newPage()}function b(a,b){this.width=~~a,this.height=~~b,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.out=new c}var f=a('/TypedNeuQuant.js',e),g=a('/SimpleQuant.js',e),h=a('/LZWEncoder.js',e);c.pageSize=4096,c.charMap={};for(var d=0;d<256;d++)c.charMap[d]=String.fromCharCode(d);c.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(c.pageSize),this.cursor=0},c.prototype.getData=function(){var d='';for(var a=0;a<this.pages.length;a++)for(var b=0;b<c.pageSize;b++)d+=c.charMap[this.pages[a][b]];return d},c.prototype.writeByte=function(a){this.cursor>=c.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=a},c.prototype.writeUTFBytes=function(b){for(var c=b.length,a=0;a<c;a++)this.writeByte(b.charCodeAt(a))},c.prototype.writeBytes=function(b,d,e){for(var c=e||b.length,a=d||0;a<c;a++)this.writeByte(b[a])},b.prototype.setDelay=function(a){this.delay=Math.round(a/10)},b.prototype.setFrameRate=function(a){this.delay=Math.round(100/a)},b.prototype.setDispose=function(a){a>=0&&(this.dispose=a)},b.prototype.setRepeat=function(a){this.repeat=a},b.prototype.setTransparent=function(a){this.transparent=a},b.prototype.setPreserveColors=function(a){this.preserveColors=a},b.prototype.addFrame=function(a){this.image=a,this.getImagePixels(),this.analyzePixels(),this.firstFrame&&(this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.writePalette(),this.writePixels(),this.firstFrame=!1},b.prototype.finish=function(){this.out.writeByte(59)},b.prototype.setQuality=function(a){a<1&&(a=1),this.sample=a},b.prototype.writeHeader=function(){this.out.writeUTFBytes('GIF89a')},b.prototype.analyzePixels=function(){var h=this.pixels.length,d=h/3;this.indexedPixels=new Uint8Array(d);var a;if(this.preserveColors){var i=this.toRGBComponents(this.transparent);a=new g(this.pixels,this.sample,i)}else a=new f(this.pixels,this.sample);a.buildColormap(),this.colorTab=a.getColormap();var b=0;for(var c=0;c<d;c++){var e=a.lookupRGB(this.pixels[b++]&255,this.pixels[b++]&255,this.pixels[b++]&255);this.usedEntry[e]=!0,this.indexedPixels[c]=e}this.pixels=null,this.colorDepth=8,this.palSize=7,this.transparent!==null&&(this.transIndex=this.findClosest(this.transparent))},b.prototype.toRGBComponents=function(a){var b=null;return a&&(b={r:(a&16711680)>>16,g:(a&65280)>>8,b:a&255}),b},b.prototype.findClosest=function(b){if(this.colorTab===null)return-1;var j=(b&16711680)>>16,k=(b&65280)>>8,l=b&255,c=0,d=16777216,m=this.colorTab.length;for(var a=0;a<m;){var e=j-(this.colorTab[a++]&255),f=k-(this.colorTab[a++]&255),g=l-(this.colorTab[a]&255),h=e*e+f*f+g*g,i=parseInt(a/3),n=this.preserveColors||this.usedEntry[i];n&&h<d&&(d=h,c=i),a++}return c},b.prototype.getImagePixels=function(){var a=this.width,g=this.height;this.pixels=new Uint8Array(a*g*3);var b=this.image,c=0;for(var d=0;d<g;d++)for(var e=0;e<a;e++){var f=d*a*4+e*4;this.pixels[c++]=b[f],this.pixels[c++]=b[f+1],this.pixels[c++]=b[f+2]}},b.prototype.writeGraphicCtrlExt=function(){this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4);var b,a;this.transparent===null?(b=0,a=0):(b=1,a=2),this.dispose>=0&&(a=dispose&7),a<<=2,this.out.writeByte(0|a|0|b),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},b.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},b.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},b.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes('NETSCAPE2.0'),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},b.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);var b=768-this.colorTab.length;for(var a=0;a<b;a++)this.out.writeByte(0)},b.prototype.writeShort=function(a){this.out.writeByte(a&255),this.out.writeByte(a>>8&255)},b.prototype.writePixels=function(){var a=new h(this.width,this.height,this.indexedPixels,this.colorDepth);a.encode(this.out)},b.prototype.stream=function(){return this.out},e.exports=b}),a.define('/LZWEncoder.js',function(e,g,h,i){function f(x,y,z,A){function t(a,b){q[h++]=a,h>=254&&v(b)}function B(b){u(a),i=k+2,j=!0,l(k,b)}function u(b){for(var a=0;a<b;++a)f[a]=-1}function C(y,p){var g,t,d,e,x,v,q;for(r=y,j=!1,n_bits=r,m=o(n_bits),k=1<<y-1,s=k+1,i=k+2,h=0,e=w(),q=0,g=a;g<65536;g*=2)++q;q=8-q,v=a,u(v),l(k,p);a:while((t=w())!=c){if(g=(t<<b)+e,d=t<<q^e,f[d]===g){e=n[d];continue}if(f[d]>=0){x=v-d,d===0&&(x=1);do if((d-=x)<0&&(d+=v),f[d]===g){e=n[d];continue a}while(f[d]>=0)}l(e,p),e=t,i<1<<b?(n[d]=i++,f[d]=g):B(p)}l(e,p),l(s,p)}function D(a){a.writeByte(p),remaining=x*y,curPixel=0,C(p+1,a),a.writeByte(0)}function v(a){h>0&&(a.writeByte(h),a.writeBytes(q,0,h),h=0)}function o(a){return(1<<a)-1}function w(){if(remaining===0)return c;--remaining;var a=z[curPixel++];return a&255}function l(a,c){g&=d[e],e>0?g|=a<<e:g=a,e+=n_bits;while(e>=8)t(g&255,c),g>>=8,e-=8;if((i>m||j)&&(j?(m=o(n_bits=r),j=!1):(++n_bits,n_bits==b?m=1<<b:m=o(n_bits))),a==s){while(e>0)t(g&255,c),g>>=8,e-=8;v(c)}}var p=Math.max(2,A),q=new Uint8Array(256),f=new Int32Array(a),n=new Int32Array(a),g,e=0,h,i=0,m,j=!1,r,k,s;this.encode=D}var c=-1,b=12,a=5003,d=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];e.exports=f}),a.define('/SimpleQuant.js',function(b,d,e,f){function a(a,b,c){return[a,b,c].join('.')}function c(c,d,b){this.pixels=c,this.palette=[],this.paletteIndex={},this.getColormap=function(){return this.palette},this.buildColormap=function(){var d=this.pixels.length/3,a=0;for(var c=0;c<d;c++){var e=this.pixels[a++],f=this.pixels[a++],g=this.pixels[a++];this.addColorToPalette(e,f,g)}b&&this.addColorToPalette(b.r,b.g,b.b)},this.addColorToPalette=function(c,d,e){var b=a(c,d,e);this.paletteIndex.hasOwnProperty(b)||(this.palette.push(c),this.palette.push(d),this.palette.push(e),this.paletteIndex[b]=this.palette.length/3-1)},this.lookupRGB=function(b,c,d){return this.paletteIndex[a(b,c,d)]}}b.exports=c}),a.define('/TypedNeuQuant.js',function(A,D,E,F){function B(y,B){function C(){k=[],l=new Int32Array(256),u=new Int32Array(a),v=new Int32Array(a),A=new Int32Array(a>>3);var c,d;for(c=0;c<a;c++)d=(c<<b+8)/a,k[c]=new Float64Array([d,d,d,0]),v[c]=e/a,u[c]=0}function D(){for(var c=0;c<a;c++)k[c][0]>>=b,k[c][1]>>=b,k[c][2]>>=b,k[c][3]=c}function E(b,a,c,e,f){k[a][0]-=b*(k[a][0]-c)/d,k[a][1]-=b*(k[a][1]-e)/d,k[a][2]-=b*(k[a][2]-f)/d}function F(j,e,l,m,n){var h=Math.abs(e-j),i=Math.min(e+j,a),f=e+1,g=e-1,o=1,b,d;while(f<i||g>h)d=A[o++],f<i&&(b=k[f++],b[0]-=d*(b[0]-l)/c,b[1]-=d*(b[1]-m)/c,b[2]-=d*(b[2]-n)/c),g>h&&(b=k[g--],b[0]-=d*(b[0]-l)/c,b[1]-=d*(b[1]-m)/c,b[2]-=d*(b[2]-n)/c)}function G(p,q,r){var e=2147483647,l=e,d=-1,m=d,c,h,i,n,o;for(c=0;c<a;c++)h=k[c],i=Math.abs(h[0]-p)+Math.abs(h[1]-q)+Math.abs(h[2]-r),i<e&&(e=i,d=c),n=i-(u[c]>>j-b),n<l&&(l=n,m=c),o=v[c]>>g,v[c]-=o,u[c]+=o<<f;return v[d]+=s,u[d]-=t,m}function H(){var d,b,e,c,h,g,f=0,j=0;for(d=0;d<a;d++){for(e=k[d],h=d,g=e[1],b=d+1;b<a;b++)c=k[b],c[1]<g&&(h=b,g=c[1]);if(c=k[h],d!=h&&(b=c[0],c[0]=e[0],e[0]=b,b=c[1],c[1]=e[1],e[1]=b,b=c[2],c[2]=e[2],e[2]=b,b=c[3],c[3]=e[3],e[3]=b),g!=f){for(l[f]=j+d>>1,b=f+1;b<g;b++)l[b]=d;f=g,j=d}}for(l[f]=j+i>>1,b=f+1;b<256;b++)l[b]=i}function I(j,i,m){var b,d,c,e=1e3,h=-1,f=l[i],g=f-1;while(f<a||g>=0)f<a&&(d=k[f],c=d[1]-i,c>=e?f=a:(f++,c<0&&(c=-c),b=d[0]-j,b<0&&(b=-b),c+=b,c<e&&(b=d[2]-m,b<0&&(b=-b),c+=b,c<e&&(e=c,h=d[3])))),g>=0&&(d=k[g],c=i-d[1],c>=e?g=-1:(g--,c<0&&(c=-c),b=d[0]-j,b<0&&(b=-b),c+=b,c<e&&(b=d[2]-m,b<0&&(b=-b),c+=b,c<e&&(e=c,h=d[3]))));return h}function J(){var c,f=y.length,C=30+(B-1)/3,v=f/(3*B),l=~~(v/r),i=d,k=w,a=k>>h;for(a<=1&&(a=0),c=0;c<a;c++)A[c]=i*((a*a-c*c)*m/(a*a));var j;f<z?(B=1,j=3):f%n!==0?j=3*n:f%o!==0?j=3*o:f%p!==0?j=3*p:j=3*q;var s,t,u,e,g=0;c=0;while(c<v)if(s=(y[g]&255)<<b,t=(y[g+1]&255)<<b,u=(y[g+2]&255)<<b,e=G(s,t,u),E(i,e,s,t,u),a!==0&&F(a,e,s,t,u),g+=j,g>=f&&(g-=f),c++,l===0&&(l=1),c%l===0)for(i-=i/C,k-=k/x,a=k>>h,a<=1&&(a=0),e=0;e<a;e++)A[e]=i*((a*a-e*e)*m/(a*a))}function K(){C(),J(),D(),H()}function L(){var b=[],g=[];for(var c=0;c<a;c++)g[k[c][3]]=c;var d=0;for(var e=0;e<a;e++){var f=g[e];b[d++]=k[f][0],b[d++]=k[f][1],b[d++]=k[f][2]}return b}var k,l,u,v,A;this.buildColormap=K,this.getColormap=L,this.lookupRGB=I}var r=100,a=256,i=a-1,b=4,j=16,e=1<<j,f=10,C=1<<f,g=10,s=e>>g,t=e<<f-g,u=a>>3,h=6,v=1<<h,w=u*v,x=30,k=10,d=1<<k,l=8,m=1<<l,y=k+l,c=1<<y,n=499,o=491,p=487,q=503,z=3*q;A.exports=B}),a('/gif.worker.coffee')}.call(this,this))
